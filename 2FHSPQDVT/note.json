{
  "paragraphs": [
    {
      "text": "%md\nCi sono diverse strategie per l\u0027ingestione di uno o più file di dati in Apache Spark:\n\n1. leggere il file come un file di testo, i dati su ciascuna riga vengono memorizzati come una unica stringa, dalla quale posso estrarre le informazioni che mi interessano per inserirle nelle diverse colonne di un dataframe.\n2. leggere il file come un file csv, fornendo uno `schema` o lasciando che Spark intuisca da solo lo schema da applicare\n3. definire una classe corrispondente ai dati da memorizzare, leggere il file e forzare il casting dei dati alla classe definita ",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 14:14:03.373",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eCi sono diverse strategie per l\u0026rsquo;ingestione di uno o più file di dati in Apache Spark:\u003c/p\u003e\n\u003col\u003e\n  \u003cli\u003eleggere il file come un file di testo, i dati su ciascuna riga vengono memorizzati come una unica stringa, dalla quale posso estrarre le informazioni che mi interessano per inserirle nelle diverse colonne di un dataframe.\u003c/li\u003e\n  \u003cli\u003eleggere il file come un file csv, fornendo uno \u003ccode\u003eschema\u003c/code\u003e o lasciando che Spark intuisca da solo lo schema da applicare\u003c/li\u003e\n  \u003cli\u003edefinire una classe corrispondente ai dati da memorizzare, leggere il file e forzare il casting dei dati alla classe definita\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596627647252_230538395",
      "id": "20200805-134047_1627063865",
      "dateCreated": "2020-08-05 13:40:47.252",
      "dateStarted": "2020-08-05 14:14:03.395",
      "dateFinished": "2020-08-05 14:14:26.667",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Leggere come file di testo",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 14:43:34.234",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eLeggere come file di testo\u003c/h2\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596629643242_-324847174",
      "id": "20200805-141403_1459420523",
      "dateCreated": "2020-08-05 14:14:03.242",
      "dateStarted": "2020-08-05 14:43:34.276",
      "dateFinished": "2020-08-05 14:43:34.410",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val df \u003d spark.read.textFile(\"D:\\\\AnacondaProjects\\\\Datasets\\\\apache.access.log.PROJECT\\\\apache.access.log.PROJECT\").cache\ndf.show(truncate\u003dfalse)",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 14:49:59.804",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------------------------------------------------------------------------------------------------------------------+\n|value                                                                                                                          |\n+-------------------------------------------------------------------------------------------------------------------------------+\n|in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] \"GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0\" 200 1839     |\n|uplherc.upl.com - - [01/Aug/1995:00:00:07 -0400] \"GET / HTTP/1.0\" 304 0                                                        |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 304 0                               |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/MOSAIC-logosmall.gif HTTP/1.0\" 304 0                             |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/USA-logosmall.gif HTTP/1.0\" 304 0                                |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:09 -0400] \"GET /images/launch-logo.gif HTTP/1.0\" 200 1713                   |\n|uplherc.upl.com - - [01/Aug/1995:00:00:10 -0400] \"GET /images/WORLD-logosmall.gif HTTP/1.0\" 304 0                              |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:10 -0400] \"GET /history/skylab/skylab.html HTTP/1.0\" 200 1687                      |\n|piweba4y.prodigy.com - - [01/Aug/1995:00:00:10 -0400] \"GET /images/launchmedium.gif HTTP/1.0\" 200 11853                        |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:11 -0400] \"GET /history/skylab/skylab-small.gif HTTP/1.0\" 200 9202                 |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:12 -0400] \"GET /images/ksclogosmall.gif HTTP/1.0\" 200 3635                         |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:12 -0400] \"GET /history/apollo/images/apollo-logo1.gif HTTP/1.0\" 200 1173   |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:13 -0400] \"GET /history/apollo/images/apollo-logo.gif HTTP/1.0\" 200 3047           |\n|uplherc.upl.com - - [01/Aug/1995:00:00:14 -0400] \"GET /images/NASA-logosmall.gif HTTP/1.0\" 304 0                               |\n|133.43.96.45 - - [01/Aug/1995:00:00:16 -0400] \"GET /shuttle/missions/sts-69/mission-sts-69.html HTTP/1.0\" 200 10566            |\n|kgtyk4.kj.yamagata-u.ac.jp - - [01/Aug/1995:00:00:17 -0400] \"GET / HTTP/1.0\" 200 7280                                          |\n|kgtyk4.kj.yamagata-u.ac.jp - - [01/Aug/1995:00:00:18 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 200 5866                 |\n|d0ucr6.fnal.gov - - [01/Aug/1995:00:00:19 -0400] \"GET /history/apollo/apollo-16/apollo-16.html HTTP/1.0\" 200 2743              |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:19 -0400] \"GET /shuttle/resources/orbiters/discovery.html HTTP/1.0\" 200 6849|\n|d0ucr6.fnal.gov - - [01/Aug/1995:00:00:20 -0400] \"GET /history/apollo/apollo-16/apollo-16-patch-small.gif HTTP/1.0\" 200 14897  |\n+-------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\r\ndf: org.apache.spark.sql.Dataset[String] \u003d [value: string]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596631303580_354087077",
      "id": "20200805-144143_1659995000",
      "dateCreated": "2020-08-05 14:41:43.580",
      "dateStarted": "2020-08-05 14:49:59.895",
      "dateFinished": "2020-08-05 14:50:05.299",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\ntra le funzioni di Spark SQL trovo [regexp_extract](https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/functions$.html) per eseguire una espressione regolare su ciasuna rig del dataframe.\n\n`def regexp_extract(e: Column, exp: String, groupIdx: Int): Column`\n\n\nI parametri della funzione sono:\n- `e`: la colonna del dataframe alla quale applicare l\u0027espressione regolare\n- `exp`: l\u0027espressione regolare nel formato \"\"\"\u003c espress. regolare \u003e\"\"\"\n- `groupIdx`: se ci sono più matching devo indicare quale voglio selezionare, il primo è 0\n",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 16:41:59.571",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003etra le funzioni di Spark SQL trovo \u003ca href\u003d\"https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/functions$.html\"\u003eregexp_extract\u003c/a\u003e per eseguire una espressione regolare su ciasuna rig del dataframe.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003edef regexp_extract(e: Column, exp: String, groupIdx: Int): Column\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eI parametri della funzione sono:\u003cbr/\u003e- \u003ccode\u003ee\u003c/code\u003e: la colonna del dataframe alla quale applicare l\u0026rsquo;espressione regolare\u003cbr/\u003e- \u003ccode\u003eexp\u003c/code\u003e: l\u0026rsquo;espressione regolare nel formato \u0026quot;\u0026quot;\u0026ldquo;\u0026lt; espress. regolare \u0026gt;\u0026rdquo;\u0026quot;\u0026quot;\u003cbr/\u003e- \u003ccode\u003egroupIdx\u003c/code\u003e: se ci sono più matching devo indicare quale voglio selezionare, il primo è 0\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596636629192_1924557175",
      "id": "20200805-161029_715105368",
      "dateCreated": "2020-08-05 16:10:29.192",
      "dateStarted": "2020-08-05 16:41:59.571",
      "dateFinished": "2020-08-05 16:41:59.740",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "import org.apache.spark.sql.functions._\n\nval df_col \u003d df.select(regexp_extract($\"value\", \"\"\"[a-zA-z0-9\\-\\.]+\"\"\", 0).alias(\"host\"),\n          regexp_extract($\"value\", \"\"\"\\[([0-9a-z-A-Z\\:\\/]+)\\s\"\"\", 1).alias(\"datetime\"),\n          regexp_extract($\"value\", \"\"\"GET\\s([\\/a-zA-Z0-9\\.\\-\\_]+)\\sHTTP\"\"\",1).alias(\"request\"),\n          regexp_extract($\"value\", \"\"\"\\\"\\s([0-9]+)\\s\"\"\",1).alias(\"code\"),\n          regexp_extract($\"value\", \"\"\"\\s([0-9]+)$\"\"\", 1).alias(\"bytes\")).cache\ndf_col.show",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 17:09:33.890",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+--------------------+--------------------+----+-----+\n|                host|            datetime|             request|code|bytes|\n+--------------------+--------------------+--------------------+----+-----+\n|   in24.inetnebr.com|01/Aug/1995:00:00:01|/shuttle/missions...| 200| 1839|\n|     uplherc.upl.com|01/Aug/1995:00:00:07|                   /| 304|    0|\n|     uplherc.upl.com|01/Aug/1995:00:00:08|/images/ksclogo-m...| 304|    0|\n|     uplherc.upl.com|01/Aug/1995:00:00:08|/images/MOSAIC-lo...| 304|    0|\n|     uplherc.upl.com|01/Aug/1995:00:00:08|/images/USA-logos...| 304|    0|\n|ix-esc-ca2-07.ix....|01/Aug/1995:00:00:09|/images/launch-lo...| 200| 1713|\n|     uplherc.upl.com|01/Aug/1995:00:00:10|/images/WORLD-log...| 304|    0|\n|slppp6.intermind.net|01/Aug/1995:00:00:10|/history/skylab/s...| 200| 1687|\n|piweba4y.prodigy.com|01/Aug/1995:00:00:10|/images/launchmed...| 200|11853|\n|slppp6.intermind.net|01/Aug/1995:00:00:11|/history/skylab/s...| 200| 9202|\n|slppp6.intermind.net|01/Aug/1995:00:00:12|/images/ksclogosm...| 200| 3635|\n|ix-esc-ca2-07.ix....|01/Aug/1995:00:00:12|/history/apollo/i...| 200| 1173|\n|slppp6.intermind.net|01/Aug/1995:00:00:13|/history/apollo/i...| 200| 3047|\n|     uplherc.upl.com|01/Aug/1995:00:00:14|/images/NASA-logo...| 304|    0|\n|        133.43.96.45|01/Aug/1995:00:00:16|/shuttle/missions...| 200|10566|\n|kgtyk4.kj.yamagat...|01/Aug/1995:00:00:17|                   /| 200| 7280|\n|kgtyk4.kj.yamagat...|01/Aug/1995:00:00:18|/images/ksclogo-m...| 200| 5866|\n|     d0ucr6.fnal.gov|01/Aug/1995:00:00:19|/history/apollo/a...| 200| 2743|\n|ix-esc-ca2-07.ix....|01/Aug/1995:00:00:19|/shuttle/resource...| 200| 6849|\n|     d0ucr6.fnal.gov|01/Aug/1995:00:00:20|/history/apollo/a...| 200|14897|\n+--------------------+--------------------+--------------------+----+-----+\nonly showing top 20 rows\n\r\nimport org.apache.spark.sql.functions._\r\ndf_col: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [host: string, datetime: string ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596636624182_1758034580",
      "id": "20200805-161024_1156523033",
      "dateCreated": "2020-08-05 16:10:24.182",
      "dateStarted": "2020-08-05 17:09:33.952",
      "dateFinished": "2020-08-05 17:09:47.931",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nVediamo per ogni colonna se ci sono elementi nulli o NaN",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 17:58:39.881",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eVediamo per ogni colonna se ci sono elementi nulli o NaN\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596642607488_1670894258",
      "id": "20200805-175007_30493775",
      "dateCreated": "2020-08-05 17:50:07.489",
      "dateStarted": "2020-08-05 17:58:39.976",
      "dateFinished": "2020-08-05 17:58:40.101",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df_col.agg(sum(when($\"host\".isNull, 1).otherwise(0)).alias(\"host-null\"),\n           sum(when($\"datetime\".isNull, 1).otherwise(0)).alias(\"datetime-null\"),\n           sum(when($\"request\".isNull, 1).otherwise(0)).alias(\"request-null\"),\n           sum(when($\"code\".isNull, 1).otherwise(0)).alias(\"code-null\"),\n           sum(when($\"bytes\".isNull, 1).otherwise(0)).alias(\"bytes-null\")).show",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 17:15:25.272",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------+-------------+------------+---------+----------+\n|host-null|datetime-null|request-null|code-null|bytes-null|\n+---------+-------------+------------+---------+----------+\n|        0|            0|           0|        0|         0|\n+---------+-------------+------------+---------+----------+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596637458012_877050581",
      "id": "20200805-162418_1263463979",
      "dateCreated": "2020-08-05 16:24:18.012",
      "dateStarted": "2020-08-05 17:15:25.324",
      "dateFinished": "2020-08-05 17:15:29.524",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df_col.agg(sum(when($\"host\".isNaN, 1).otherwise(0)).alias(\"host-nan\"),\n           sum(when($\"datetime\".isNaN, 1).otherwise(0)).alias(\"datetime-nan\"),\n           sum(when($\"request\".isNaN, 1).otherwise(0)).alias(\"request-nan\"),\n           sum(when($\"code\".isNaN, 1).otherwise(0)).alias(\"code-nan\"),\n           sum(when($\"bytes\".isNaN, 1).otherwise(0)).alias(\"bytes-nan\")).show",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 17:57:06.493",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+------------+-----------+--------+---------+\n|host-nan|datetime-nan|request-nan|code-nan|bytes-nan|\n+--------+------------+-----------+--------+---------+\n|       0|           0|          0|       0|        0|\n+--------+------------+-----------+--------+---------+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596642759979_165389990",
      "id": "20200805-175239_158420232",
      "dateCreated": "2020-08-05 17:52:39.979",
      "dateStarted": "2020-08-05 17:57:06.559",
      "dateFinished": "2020-08-05 17:57:17.477",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df_col.select($\"datetime\").count",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 17:27:21.851",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res19: Long \u003d 1043177\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596640278976_1914588920",
      "id": "20200805-171118_39255845",
      "dateCreated": "2020-08-05 17:11:18.976",
      "dateStarted": "2020-08-05 17:27:21.930",
      "dateFinished": "2020-08-05 17:27:24.997",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nSembra che questo approccio abbia funzionato bene e i valori siano stati estratti correttamente in ogni riga.",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 18:03:01.656",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eSembra che questo approccio abbia funzionato bene e i valori siano stati estratti correttamente in ogni riga.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596643263333_-1291549174",
      "id": "20200805-180103_936818779",
      "dateCreated": "2020-08-05 18:01:03.333",
      "dateStarted": "2020-08-05 18:03:01.664",
      "dateFinished": "2020-08-05 18:03:01.756",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Leggere il file come csv\n\nVediamo innanzitutto come è composta una riga:\n\n`in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] \"GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0\" 200 1839`\n\npossiamo usare lo spazio come separatore e poi eliminare le colonne che non servono.",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 18:23:21.747",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eLeggere il file come csv\u003c/h2\u003e\n\u003cp\u003eVediamo innanzitutto come è composta una riga:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ein24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] \u0026quot;GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0\u0026quot; 200 1839\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003epossiamo usare lo spazio come separatore e poi eliminare le colonne che non servono.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596641241851_2131586085",
      "id": "20200805-172721_643585193",
      "dateCreated": "2020-08-05 17:27:21.852",
      "dateStarted": "2020-08-05 18:23:21.762",
      "dateFinished": "2020-08-05 18:23:21.806",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val df \u003d spark.read.format(\"csv\").option(\"header\",\"false\").option(\"sep\",\" \").load(\"D:\\\\AnacondaProjects\\\\Datasets\\\\apache.access.log.PROJECT\\\\apache.access.log.PROJECT\").drop(\"_c1\",\"_c2\",\"_c4\").toDF(\"host\",\"datetime\",\"request\",\"code\",\"bytes\").cache\ndf.show(5)",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:55:09.339",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+--------------------+--------------------+----+-----+\n|             host|            datetime|             request|code|bytes|\n+-----------------+--------------------+--------------------+----+-----+\n|in24.inetnebr.com|[01/Aug/1995:00:0...|GET /shuttle/miss...| 200| 1839|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|      GET / HTTP/1.0| 304|    0|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/ksclo...| 304|    0|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/MOSAI...| 304|    0|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/USA-l...| 304|    0|\n+-----------------+--------------------+--------------------+----+-----+\nonly showing top 5 rows\n\r\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [host: string, datetime: string ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596644699644_1680348172",
      "id": "20200805-182459_921809117",
      "dateCreated": "2020-08-05 18:24:59.644",
      "dateStarted": "2020-08-06 11:55:09.445",
      "dateFinished": "2020-08-06 11:55:11.959",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df.select( sum(when($\"host\".isNull, 1).otherwise(0)).alias(\"host-null\"),\n           sum(when($\"datetime\".isNull, 1).otherwise(0)).alias(\"datetime-null\"),\n           sum(when($\"request\".isNull, 1).otherwise(0)).alias(\"request-null\"),\n           sum(when($\"code\".isNull, 1).otherwise(0)).alias(\"code-null\"),\n           sum(when($\"bytes\".isNull, 1).otherwise(0)).alias(\"bytes-null\")).show",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 18:38:11.753",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------+-------------+------------+---------+----------+\n|host-null|datetime-null|request-null|code-null|bytes-null|\n+---------+-------------+------------+---------+----------+\n|        0|            0|           0|        0|         0|\n+---------+-------------+------------+---------+----------+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596645255935_-1572629377",
      "id": "20200805-183415_866627426",
      "dateCreated": "2020-08-05 18:34:15.935",
      "dateStarted": "2020-08-05 18:38:11.880",
      "dateFinished": "2020-08-05 18:38:14.536",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nVediamo lo schema del dataframe",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 18:52:48.651",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eVediamo lo schema del dataframe\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596646349677_1660730385",
      "id": "20200805-185229_1768362473",
      "dateCreated": "2020-08-05 18:52:29.677",
      "dateStarted": "2020-08-05 18:52:48.683",
      "dateFinished": "2020-08-05 18:52:48.717",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df.printSchema",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 18:38:32.679",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- host: string (nullable \u003d true)\n |-- datetime: string (nullable \u003d true)\n |-- request: string (nullable \u003d true)\n |-- code: string (nullable \u003d true)\n |-- bytes: string (nullable \u003d true)\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596645395065_958104125",
      "id": "20200805-183635_1317460593",
      "dateCreated": "2020-08-05 18:36:35.065",
      "dateStarted": "2020-08-05 18:38:32.775",
      "dateFinished": "2020-08-05 18:38:33.822",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nApplichiamo describe ad ogni colonna del datatframe",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 18:54:55.051",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eApplichiamo describe ad ogni colonna del datatframe\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596646346641_-2146983176",
      "id": "20200805-185226_1430115867",
      "dateCreated": "2020-08-05 18:52:26.642",
      "dateStarted": "2020-08-05 18:54:55.070",
      "dateFinished": "2020-08-05 18:54:55.110",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df.describe(\"host\",\"datetime\",\"request\",\"code\",\"bytes\").show(truncate\u003dfalse)",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:55:21.859",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-------------------------+---------------------+-------------------------------------------------------------+------------------+------------------+\n|summary|host                     |datetime             |request                                                      |code              |bytes             |\n+-------+-------------------------+---------------------+-------------------------------------------------------------+------------------+------------------+\n|count  |1043177                  |1043177              |1043177                                                      |1043177           |1043177           |\n|mean   |null                     |null                 |null                                                         |210.77027485611083|17679.736875431394|\n|stddev |null                     |null                 |null                                                         |33.52356783510582 |68832.10308836344 |\n|min    |***.novo.dk              |[01/Aug/1995:00:00:01|GET /                                                        |200               |-                 |\n|max    |zztduffy.slip.cc.uq.oz.au|[22/Aug/1995:23:59:59|POST /shuttle/missions/sts-73/sts-73-patch-small.gif HTTP/1.0|HTTP/1.0\"         |99981             |\n+-------+-------------------------+---------------------+-------------------------------------------------------------+------------------+------------------+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596645512679_-904410099",
      "id": "20200805-183832_147538782",
      "dateCreated": "2020-08-05 18:38:32.679",
      "dateStarted": "2020-08-06 11:55:21.974",
      "dateFinished": "2020-08-06 11:55:59.865",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nDalla tabella sopra ottengo due importanti informazioni:\n- nella colonna request ci sono sia GET che POST\n- nella colonna code alcuni valori sono sbagliati, contengono la stringa \"HTTP/1.0\"\" invece dei codici numerici\n- nella colonna bytes alcuni valori sono non numerici e sono rappresentati come \"-\" per questo non è risultato come Null o NaN ",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:57:24.129",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": false,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eDalla tabella sopra ottengo una importante informazione che nella colonna bytes alcuni valori sono non numerici e sono rappresentati come \u0026ldquo;-\u0026rdquo; per questo non è risultato come Null o NaN\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596646505133_-813731538",
      "id": "20200805-185505_1176722985",
      "dateCreated": "2020-08-05 18:55:05.133",
      "dateStarted": "2020-08-05 19:11:13.599",
      "dateFinished": "2020-08-05 19:11:13.772",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nFiltriamo gli elementi di code che sono malformati, ovvero che contengono valori non numerici",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:17:48.490",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eFiltriamo gli elementi di code che sono malformati, ovvero che contengono valori non numerici\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596661974521_-579249449",
      "id": "20200805-231254_666382632",
      "dateCreated": "2020-08-05 23:12:54.521",
      "dateStarted": "2020-08-06 11:17:48.499",
      "dateFinished": "2020-08-06 11:17:48.558",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df.filter($\"code\" contains \"HTTP/1.0\").show(truncate\u003dfalse)",
      "user": "anonymous",
      "dateUpdated": "2020-08-05 23:14:43.689",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------------+---------------------+-----------------------------------------------------+---------+-----+\n|host                     |datetime             |request                                              |code     |bytes|\n+-------------------------+---------------------+-----------------------------------------------------+---------+-----+\n|jhanley.doe.state.la.us  |[08/Aug/1995:11:24:31|GET /ksc.html                                        |HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:18:45:48|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:18:45:49|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|128.95.234.46            |[10/Aug/1995:19:25:40|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:20:08:13|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:20:08:13|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:20:08:41|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:20:08:41|GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:20:09:31|GET /shuttle/missions/sts-70/images/KSC-95EC-o667.gif|HTTP/1.0\"|404  |\n|redx3.cac.washington.edu |[10/Aug/1995:20:09:32|GET /shuttle/missions/sts-70/images/KSC-95EC-o667.gif|HTTP/1.0\"|404  |\n|macba305.aerov.jussieu.fr|[22/Aug/1995:11:03:15|GET /shuttle/missions/sts-9/sts-9-patch-small.gif    |HTTP/1.0\"|404  |\n|macba305.aerov.jussieu.fr|[22/Aug/1995:11:03:18|GET /shuttle/missions/sts-45/sts-45-patch-small.gif  |HTTP/1.0\"|404  |\n|macba305.aerov.jussieu.fr|[22/Aug/1995:11:03:19|GET /shuttle/missions/sts-57/sts-57-patch-small.gif\" |HTTP/1.0\"|404  |\n+-------------------------+---------------------+-----------------------------------------------------+---------+-----+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596661999336_1523546916",
      "id": "20200805-231319_1825265572",
      "dateCreated": "2020-08-05 23:13:19.336",
      "dateStarted": "2020-08-05 23:14:43.789",
      "dateFinished": "2020-08-05 23:14:45.988",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nCi dovremmo chiedere come mai questo errore nell\u0027ingestione di queste righe. Dovremmo cercare di filtrare queste righe senza però suddividere in colonne.\n\nCi torna utile leggere il file come textfile e filtrare le righe che contengono le richieste del filtro sopra.",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:24:01.927",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eCi dovremmo chiedere come mai questo errore nell\u0026rsquo;ingestione di queste righe. Dovremmo cercare di filtrare queste righe senza però suddividere in colonne.\u003c/p\u003e\n\u003cp\u003eCi torna utile leggere il file come textfile e filtrare le righe che contengono le richieste del filtro sopra.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596705486880_1138308112",
      "id": "20200806-111806_373185590",
      "dateCreated": "2020-08-06 11:18:06.880",
      "dateStarted": "2020-08-06 11:24:01.930",
      "dateFinished": "2020-08-06 11:24:01.991",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val df_text \u003d spark.read.textFile(\"D:\\\\AnacondaProjects\\\\Datasets\\\\apache.access.log.PROJECT\\\\apache.access.log.PROJECT\").filter(\n    ($\"value\" contains \"GET /ksc.html\") \u0026\u0026 ($\"value\" contains \"08/Aug/1995:11:24:31\") ||\n    ($\"value\" contains \"/shuttle/missions/sts-70/images/ksc-95ec-o667.gif\") \u0026\u0026 (($\"value\" contains \"10/Aug/1995:18:45:48\") ||\n                                                                                ($\"value\" contains \"10/Aug/1995:18:45:49\") ||\n                                                                                ($\"value\" contains \"10/Aug/1995:19:25:40\") ||\n                                                                                ($\"value\" contains \"10/Aug/1995:20:08:13\") ||\n                                                                                ($\"value\" contains \"10/Aug/1995:20:08:41\") ||\n                                                                                ($\"value\" contains \"10/Aug/1995:20:09:31\") ||\n                                                                                ($\"value\" contains \"10/Aug/1995:20:09:32\")) ||\n    (($\"value\" contains \"GET /shuttle/missions/sts-9/sts-9-patch-small.gif\") \u0026\u0026 ($\"value\" contains \"22/Aug/1995:11:03:15\")) ||\n    (($\"value\" contains \"GET /shuttle/missions/sts-45/sts-45-patch-small.gif\") \u0026\u0026 ($\"value\" contains \"22/Aug/1995:11:03:18\")) ||\n    (($\"value\" contains \"GET /shuttle/missions/sts-57/sts-57-patch-small.gif\") \u0026\u0026 ($\"value\" contains \"22/Aug/1995:11:03:19\")))\n\ndf_text.show(truncate\u003dfalse)\n",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:54:48.756",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------------------------------------------------------------------------------------------------------------------------------+\n|value                                                                                                                            |\n+---------------------------------------------------------------------------------------------------------------------------------+\n|jhanley.doe.state.la.us - - [08/Aug/1995:11:24:31 -0400] \"GET /ksc.html\" HTTP/1.0\" 404 -                                         |\n|redx3.cac.washington.edu - - [10/Aug/1995:18:45:48 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -|\n|redx3.cac.washington.edu - - [10/Aug/1995:18:45:49 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -|\n|128.95.234.46 - - [10/Aug/1995:19:25:40 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -           |\n|redx3.cac.washington.edu - - [10/Aug/1995:20:08:13 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -|\n|redx3.cac.washington.edu - - [10/Aug/1995:20:08:13 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -|\n|redx3.cac.washington.edu - - [10/Aug/1995:20:08:41 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -|\n|redx3.cac.washington.edu - - [10/Aug/1995:20:08:41 -0400] \"GET /shuttle/missions/sts-70/images/ksc-95ec-o667.gif\" HTTP/1.0\" 404 -|\n|macba305.aerov.jussieu.fr - - [22/Aug/1995:11:03:15 -0400] \"GET /shuttle/missions/sts-9/sts-9-patch-small.gif\" HTTP/1.0\" 404 -   |\n|macba305.aerov.jussieu.fr - - [22/Aug/1995:11:03:18 -0400] \"GET /shuttle/missions/sts-45/sts-45-patch-small.gif\" HTTP/1.0\" 404 - |\n|macba305.aerov.jussieu.fr - - [22/Aug/1995:11:03:19 -0400] \"GET /shuttle/missions/sts-57/sts-57-patch-small.gif\"\" HTTP/1.0\" 404 -|\n+---------------------------------------------------------------------------------------------------------------------------------+\n\r\ndf_text: org.apache.spark.sql.Dataset[String] \u003d [value: string]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596705770366_57114483",
      "id": "20200806-112250_827451570",
      "dateCreated": "2020-08-06 11:22:50.366",
      "dateStarted": "2020-08-06 11:54:28.589",
      "dateFinished": "2020-08-06 11:54:34.381",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nCome si vede le righe in questione sono tutte malformate, cioè invece di essere nel formato `\"GET \u003curl\u003e HTTP/1.0\"` hanno degli extra \".\n\nSi noti che \" è il simbolo quote di default nel csv dataframe reader, cioè quello che vi è tra virgolette viene considerato come un\u0027unica stringa anche se c\u0027è un carattere separator (lo spazio nel nostro caso) in mezzo. Per questo motivo `\"GET \u003curl\u003e HTTP/1.0\"` è visto come una unica stringa. Se invece ci sono altre virgolette in mezzo la lettura e la separazione della riga in field non funzionerà.\n\nA questo punto ho due opzioni:\n- correggere queste righe manualmente\n- eliminare queste righe\n\nVisto che non sono molte, e che non mi sembrano particolarmente importanti (anche se sono tutti codici 404, page not found) decido di eliminare queste righe.",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 11:46:02.738",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eCome si vede le righe in questione sono tutte malformate, cioè invece di essere nel formato \u003ccode\u003e\u0026quot;GET \u0026lt;url\u0026gt; HTTP/1.0\u0026quot;\u003c/code\u003e hanno degli extra \u0026quot;.\u003c/p\u003e\n\u003cp\u003eSi noti che \u0026quot; è il simbolo quote di default nel csv dataframe reader, cioè quello che vi è tra virgolette viene considerato come un\u0026rsquo;unica stringa anche se c\u0026rsquo;è un carattere separator (lo spazio nel nostro caso) in mezzo. Per questo motivo \u003ccode\u003e\u0026quot;GET \u0026lt;url\u0026gt; HTTP/1.0\u0026quot;\u003c/code\u003e è visto come una unica stringa. Se invece ci sono altre virgolette in mezzo la lettura e la separazione della riga in field non funzionerà.\u003c/p\u003e\n\u003cp\u003eA questo punto ho due opzioni:\u003cbr/\u003e- correggere queste righe manualmente\u003cbr/\u003e- eliminare queste righe\u003c/p\u003e\n\u003cp\u003eVisto che non sono molte, e che non mi sembrano particolarmente importanti (anche se sono tutti codici 404, page not found) decido di eliminare queste righe.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596706060428_1018291061",
      "id": "20200806-112740_69879454",
      "dateCreated": "2020-08-06 11:27:40.428",
      "dateStarted": "2020-08-06 11:46:02.740",
      "dateFinished": "2020-08-06 11:46:02.799",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val df_clean \u003d df.filter(not(col(\"code\").contains(\"HTTP\"))).cache\ndf_clean.show\n",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 14:05:42.633",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+--------------------+--------------------+----+-----+\n|                host|            datetime|             request|code|bytes|\n+--------------------+--------------------+--------------------+----+-----+\n|   in24.inetnebr.com|[01/Aug/1995:00:0...|GET /shuttle/miss...| 200| 1839|\n|     uplherc.upl.com|[01/Aug/1995:00:0...|      GET / HTTP/1.0| 304|    0|\n|     uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/ksclo...| 304|    0|\n|     uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/MOSAI...| 304|    0|\n|     uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/USA-l...| 304|    0|\n|ix-esc-ca2-07.ix....|[01/Aug/1995:00:0...|GET /images/launc...| 200| 1713|\n|     uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/WORLD...| 304|    0|\n|slppp6.intermind.net|[01/Aug/1995:00:0...|GET /history/skyl...| 200| 1687|\n|piweba4y.prodigy.com|[01/Aug/1995:00:0...|GET /images/launc...| 200|11853|\n|slppp6.intermind.net|[01/Aug/1995:00:0...|GET /history/skyl...| 200| 9202|\n|slppp6.intermind.net|[01/Aug/1995:00:0...|GET /images/ksclo...| 200| 3635|\n|ix-esc-ca2-07.ix....|[01/Aug/1995:00:0...|GET /history/apol...| 200| 1173|\n|slppp6.intermind.net|[01/Aug/1995:00:0...|GET /history/apol...| 200| 3047|\n|     uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/NASA-...| 304|    0|\n|        133.43.96.45|[01/Aug/1995:00:0...|GET /shuttle/miss...| 200|10566|\n|kgtyk4.kj.yamagat...|[01/Aug/1995:00:0...|      GET / HTTP/1.0| 200| 7280|\n|kgtyk4.kj.yamagat...|[01/Aug/1995:00:0...|GET /images/ksclo...| 200| 5866|\n|     d0ucr6.fnal.gov|[01/Aug/1995:00:0...|GET /history/apol...| 200| 2743|\n|ix-esc-ca2-07.ix....|[01/Aug/1995:00:0...|GET /shuttle/reso...| 200| 6849|\n|     d0ucr6.fnal.gov|[01/Aug/1995:00:0...|GET /history/apol...| 200|14897|\n+--------------------+--------------------+--------------------+----+-----+\nonly showing top 20 rows\n\r\ndf_clean: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [host: string, datetime: string ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596707495334_-1873575968",
      "id": "20200806-115135_142456605",
      "dateCreated": "2020-08-06 11:51:35.334",
      "dateStarted": "2020-08-06 14:05:42.771",
      "dateFinished": "2020-08-06 14:05:49.084",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nPotrebbe essere una buona idea quella di convertire in interi le ultime due colonne.\n\nDefiniamo una funzione in Scala e poi la convertiamo in UDF (User Defined Function) per usarla in Spark.\n\nLa funzione `st_to_int` definita sotto converte una stringa in interi. Una struttura try-catch fa in modo che quando non sia possibile convertire a intero, perchè ho una riga malformata, la funzione ritorna -9999 o 0 nel caso che bytes sia uguale a \"-\".",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 14:14:34.896",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003ePotrebbe essere una buona idea quella di convertire in interi le ultime due colonne.\u003c/p\u003e\n\u003cp\u003eDefiniamo una funzione in Scala e poi la convertiamo in UDF (User Defined Function) per usarla in Spark.\u003c/p\u003e\n\u003cp\u003eLa funzione \u003ccode\u003est_to_int\u003c/code\u003e definita sotto converte una stringa in interi. Una struttura try-catch fa in modo che quando non sia possibile convertire a intero, perchè ho una riga malformata, la funzione ritorna -9999 o 0 nel caso che bytes sia uguale a \u0026ldquo;-\u0026rdquo;.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596645791994_1539895915",
      "id": "20200805-184311_1161347874",
      "dateCreated": "2020-08-05 18:43:11.994",
      "dateStarted": "2020-08-06 14:14:34.912",
      "dateFinished": "2020-08-06 14:14:34.981",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "\n//val st_to_int : String \u003d\u003e Int \u003d x \u003d\u003e x.toInt\n\ndef st_to_int (x: String): Int \u003d {\n    \n    try {\n        x.toInt\n    } catch {\n        case ex: NumberFormatException \u003d\u003e \n            { if (x \u003d\u003d \"-\") 0 else -9999 }\n    }\n    \n}\nval udf_st_to_int \u003d udf(st_to_int _)\n\nval df_conv \u003d df_clean.withColumn(\"code\", udf_st_to_int($\"code\")).withColumn(\"bytes\", udf_st_to_int($\"bytes\"))\ndf_conv.show(5)\ndf_conv.printSchema",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 14:13:16.459",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+--------------------+--------------------+----+-----+\n|             host|            datetime|             request|code|bytes|\n+-----------------+--------------------+--------------------+----+-----+\n|in24.inetnebr.com|[01/Aug/1995:00:0...|GET /shuttle/miss...| 200| 1839|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|      GET / HTTP/1.0| 304|    0|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/ksclo...| 304|    0|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/MOSAI...| 304|    0|\n|  uplherc.upl.com|[01/Aug/1995:00:0...|GET /images/USA-l...| 304|    0|\n+-----------------+--------------------+--------------------+----+-----+\nonly showing top 5 rows\n\r\nroot\n |-- host: string (nullable \u003d true)\n |-- datetime: string (nullable \u003d true)\n |-- request: string (nullable \u003d true)\n |-- code: integer (nullable \u003d false)\n |-- bytes: integer (nullable \u003d false)\n\r\nst_to_int: (x: String)Int\r\nudf_st_to_int: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction1\u003e,IntegerType,Some(List(StringType)))\r\ndf_conv: org.apache.spark.sql.DataFrame \u003d [host: string, datetime: string ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596645691808_-1731636083",
      "id": "20200805-184131_1222963581",
      "dateCreated": "2020-08-05 18:41:31.808",
      "dateStarted": "2020-08-06 14:13:16.531",
      "dateFinished": "2020-08-06 14:13:18.742",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nVerifichiamo di avere corretto tutti i problemi usando la funzione `describe` dui dataframe prima e dopo.",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 14:19:16.417",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eVerifichiamo di avere corretto tutti i problemi usando la funzione \u003ccode\u003edescribe\u003c/code\u003e dui dataframe prima e dopo.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596716307899_1931694480",
      "id": "20200806-141827_2038544370",
      "dateCreated": "2020-08-06 14:18:27.900",
      "dateStarted": "2020-08-06 14:19:16.428",
      "dateFinished": "2020-08-06 14:19:16.456",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df.describe(\"code\",\"bytes\").show",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 14:07:10.885",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+\n|summary|              code|             bytes|\n+-------+------------------+------------------+\n|  count|           1043177|           1043177|\n|   mean|210.77027485611083|17679.736875431394|\n| stddev| 33.52356783510582| 68832.10308836344|\n|    min|               200|                 -|\n|    max|         HTTP/1.0\"|             99981|\n+-------+------------------+------------------+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596648076950_-431102989",
      "id": "20200805-192116_975385808",
      "dateCreated": "2020-08-05 19:21:16.950",
      "dateStarted": "2020-08-06 14:07:10.967",
      "dateFinished": "2020-08-06 14:07:14.730",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df_conv.describe(\"code\",\"bytes\").show",
      "user": "anonymous",
      "dateUpdated": "2020-08-06 14:13:25.998",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+-----------------+\n|summary|              code|            bytes|\n+-------+------------------+-----------------+\n|  count|           1043164|          1043164|\n|   mean|210.77027485611083|17531.77418219954|\n| stddev| 33.52356783510582|68562.39834125541|\n|    min|               200|                0|\n|    max|               501|          3421948|\n+-------+------------------+-----------------+\n\r\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596648416314_-488190027",
      "id": "20200805-192656_4364144",
      "dateCreated": "2020-08-05 19:26:56.314",
      "dateStarted": "2020-08-06 14:13:26.086",
      "dateFinished": "2020-08-06 14:13:28.378",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "user": "anonymous",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1596661299588_-1881521838",
      "id": "20200805-230139_1881734347",
      "dateCreated": "2020-08-05 23:01:39.588",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Ingestione dei dati in Apache Spark",
  "id": "2FHSPQDVT",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}